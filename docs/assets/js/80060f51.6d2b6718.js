"use strict";(globalThis.webpackChunk_promptly_docs=globalThis.webpackChunk_promptly_docs||[]).push([[7209],{905(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"engineering/software/backend/security/oauth2","title":"\ud83d\udd11 OAuth 2.0","description":"\ud83d\udcda Table of Contents","source":"@site/docs/engineering/software/backend/security/oauth2.md","sourceDirName":"engineering/software/backend/security","slug":"/engineering/software/backend/security/oauth2","permalink":"/promptly/docs/engineering/software/backend/security/oauth2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/engineering/software/backend/security/oauth2.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udd10 OpenID Connect (OIDC)","permalink":"/promptly/docs/engineering/software/backend/security/oidc"},"next":{"title":"\ud83e\uddfe JSON Web Token (JWT)","permalink":"/promptly/docs/engineering/software/backend/security/jwt"}}');var r=s(8525),t=s(2327);const l={sidebar_position:2},o="\ud83d\udd11 OAuth 2.0",c={},d=[{value:"\ud83d\udcda Table of Contents",id:"-table-of-contents",level:2},{value:"\ud83c\udfd7\ufe0f Context-owned",id:"\ufe0f-context-owned",level:2},{value:"\ud83d\udc64 Who (Role / Persona)",id:"-who-role--persona",level:3},{value:"Default Persona (Recommended)",id:"default-persona-recommended",level:4},{value:"Expected Expertise",id:"expected-expertise",level:4},{value:"\ud83d\udee0\ufe0f How (Format / Constraints / Style)",id:"\ufe0f-how-format--constraints--style",level:3},{value:"\ud83d\udce6 Format / Output",id:"-format--output",level:4},{value:"\u2699\ufe0f Constraints (OAuth2 Best-Practice Rules)",id:"\ufe0f-constraints-oauth2-best-practice-rules",level:4},{value:"\ud83e\uddf1 Protocol Components &amp; Architecture",id:"-protocol-components--architecture",level:4},{value:"\ud83d\udd10 Tokens, Scopes &amp; Grant Types",id:"-tokens-scopes--grant-types",level:4},{value:"\ud83e\uddea Security, Validation &amp; Operations",id:"-security-validation--operations",level:4},{value:"\ud83d\udcdd Explanation Style",id:"-explanation-style",level:4},{value:"\u270d\ufe0f User-owned",id:"\ufe0f-user-owned",level:2},{value:"\ud83d\udccc What (Task / Action)",id:"-what-task--action",level:3},{value:"\ud83c\udfaf Why (Intent / Goal)",id:"-why-intent--goal",level:3},{value:"\ud83d\udccd Where (Context / Situation)",id:"-where-context--situation",level:3},{value:"\u23f0 When (Time / Phase / Lifecycle)",id:"-when-time--phase--lifecycle",level:3},{value:"\ud83d\udd17 Final Prompt Template (Recommended Order)",id:"-final-prompt-template-recommended-order",level:2},{value:"1\ufe0f\u20e3 Persistent Context (Put in security docs or README)",id:"1\ufe0f\u20e3-persistent-context-put-in-security-docs-or-readme",level:3},{value:"2\ufe0f\u20e3 User Prompt Template",id:"2\ufe0f\u20e3-user-prompt-template",level:3},{value:"\u2705 Fully Filled Example",id:"-fully-filled-example",level:3},{value:"\ud83e\udde0 Why This Ordering Works",id:"-why-this-ordering-works",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-oauth-20",children:"\ud83d\udd11 OAuth 2.0"})}),"\n",(0,r.jsx)(n.h2,{id:"-table-of-contents",children:"\ud83d\udcda Table of Contents"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#-oauth-20",children:"\ud83d\udd11 OAuth 2.0"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-table-of-contents",children:"\ud83d\udcda Table of Contents"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#%EF%B8%8F-context-owned",children:"\ud83c\udfd7\ufe0f Context-owned"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#-who-role--persona",children:"\ud83d\udc64 Who (Role / Persona)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#default-persona-recommended",children:"Default Persona (Recommended)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#expected-expertise",children:"Expected Expertise"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#%EF%B8%8F-how-format--constraints--style",children:"\ud83d\udee0\ufe0f How (Format / Constraints / Style)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-format--output",children:"\ud83d\udce6 Format / Output"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#%EF%B8%8F-constraints-oauth2-best-practice-rules",children:"\u2699\ufe0f Constraints (OAuth2 Best-Practice Rules)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-protocol-components--architecture",children:"\ud83e\uddf1 Protocol Components & Architecture"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-tokens-scopes--grant-types",children:"\ud83d\udd10 Tokens, Scopes & Grant Types"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-security-validation--operations",children:"\ud83e\uddea Security, Validation & Operations"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-explanation-style",children:"\ud83d\udcdd Explanation Style"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#%EF%B8%8F-user-owned",children:"\u270d\ufe0f User-owned"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-what-task--action",children:"\ud83d\udccc What (Task / Action)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-why-intent--goal",children:"\ud83c\udfaf Why (Intent / Goal)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-where-context--situation",children:"\ud83d\udccd Where (Context / Situation)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-when-time--phase--lifecycle",children:"\u23f0 When (Time / Phase / Lifecycle)"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#-final-prompt-template-recommended-order",children:"\ud83d\udd17 Final Prompt Template (Recommended Order)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#1%EF%B8%8F%E2%83%A3-persistent-context-put-in-security-docs-or-readme",children:"1\ufe0f\u20e3 Persistent Context (Put in security docs or README)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#2%EF%B8%8F%E2%83%A3-user-prompt-template",children:"2\ufe0f\u20e3 User Prompt Template"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-fully-filled-example",children:"\u2705 Fully Filled Example"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#-why-this-ordering-works",children:"\ud83e\udde0 Why This Ordering Works"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This framework is ",(0,r.jsx)(n.strong,{children:"OAuth2-first"})," and optimized for ",(0,r.jsx)(n.strong,{children:"delegated authorization"}),":\nAPI access control, third-party integrations, service-to-service security, and zero-trust systems."]}),"\n",(0,r.jsxs)(n.p,{children:["It combines ",(0,r.jsx)(n.strong,{children:"5W1H"})," with ",(0,r.jsx)(n.strong,{children:"Good Prompt principles"}),(0,r.jsx)(n.br,{}),"\n","(",(0,r.jsx)(n.strong,{children:"Clear role \xb7 Clear format \xb7 Clear goal \xb7 Clear context \xb7 Clear constraints"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:["The key idea:",(0,r.jsx)(n.br,{}),"\n","\ud83d\udc49 ",(0,r.jsx)(n.strong,{children:"OAuth2 does NOT define identity"}),(0,r.jsx)(n.br,{}),"\n","\ud83d\udc49 ",(0,r.jsx)(n.strong,{children:"OAuth2 defines how access is granted"}),(0,r.jsx)(n.br,{}),"\n","\ud83d\udc49 ",(0,r.jsx)(n.strong,{children:"Scopes + audiences define power"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-context-owned",children:"\ud83c\udfd7\ufe0f Context-owned"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["These sections are ",(0,r.jsx)(n.strong,{children:"owned by the prompt context"}),".",(0,r.jsx)(n.br,{}),"\n","They ensure ",(0,r.jsx)(n.strong,{children:"secure, standards-compliant, production-grade OAuth2 guidance"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-who-role--persona",children:"\ud83d\udc64 Who (Role / Persona)"}),"\n",(0,r.jsx)(n.h4,{id:"default-persona-recommended",children:"Default Persona (Recommended)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["You are a ",(0,r.jsx)(n.strong,{children:"senior security / IAM / backend engineer"})]}),"\n",(0,r.jsxs)(n.li,{children:["Think in ",(0,r.jsx)(n.strong,{children:"trust boundaries, threat models, and API contracts"})]}),"\n",(0,r.jsxs)(n.li,{children:["Assume ",(0,r.jsx)(n.strong,{children:"distributed systems and hostile networks"})]}),"\n",(0,r.jsxs)(n.li,{children:["Optimize for ",(0,r.jsx)(n.strong,{children:"least privilege, revocability, and correctness"})]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"expected-expertise",children:"Expected Expertise"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OAuth 2.0 core specification (RFC 6749)"}),"\n",(0,r.jsx)(n.li,{children:"Grant types and their trade-offs"}),"\n",(0,r.jsx)(n.li,{children:"Access tokens vs refresh tokens"}),"\n",(0,r.jsx)(n.li,{children:"Scopes, audiences, and consent"}),"\n",(0,r.jsx)(n.li,{children:"Token introspection & revocation"}),"\n",(0,r.jsx)(n.li,{children:"JWT vs opaque tokens"}),"\n",(0,r.jsx)(n.li,{children:"API gateway & backend enforcement"}),"\n",(0,r.jsx)(n.li,{children:"Common OAuth2 attacks and mitigations"}),"\n",(0,r.jsx)(n.li,{children:"Integration with OIDC (but not conflating them)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"\ufe0f-how-format--constraints--style",children:"\ud83d\udee0\ufe0f How (Format / Constraints / Style)"}),"\n",(0,r.jsx)(n.h4,{id:"-format--output",children:"\ud83d\udce6 Format / Output"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Prefer:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Protocol-level explanations"}),"\n",(0,r.jsx)(n.li,{children:"Clear separation of responsibilities"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Explain:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"who"})," is delegating access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"what"})," is being accessed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.em,{children:"why"})," a grant type is chosen"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Use:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Flow diagrams (conceptually)"}),"\n",(0,r.jsx)(n.li,{children:"Bullet points"}),"\n",(0,r.jsx)(n.li,{children:"Tables for grant comparisons"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"\ufe0f-constraints-oauth2-best-practice-rules",children:"\u2699\ufe0f Constraints (OAuth2 Best-Practice Rules)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"Authorization Code Flow"})," for user-based access"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.strong,{children:"PKCE"})," for public clients"]}),"\n",(0,r.jsx)(n.li,{children:"Never use Implicit Flow"}),"\n",(0,r.jsxs)(n.li,{children:["Scopes must be ",(0,r.jsx)(n.strong,{children:"minimal and explicit"})]}),"\n",(0,r.jsxs)(n.li,{children:["Access tokens must be ",(0,r.jsx)(n.strong,{children:"audience-restricted"})]}),"\n",(0,r.jsxs)(n.li,{children:["Prefer ",(0,r.jsx)(n.strong,{children:"short-lived access tokens"})]}),"\n",(0,r.jsx)(n.li,{children:"Use refresh tokens carefully"}),"\n",(0,r.jsx)(n.li,{children:"Do not embed authorization logic in the client"}),"\n",(0,r.jsx)(n.li,{children:"Assume access tokens can leak"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"-protocol-components--architecture",children:"\ud83e\uddf1 Protocol Components & Architecture"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource Owner"}),(0,r.jsx)(n.br,{}),"\n","Owns the data (user or system)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Client"}),(0,r.jsx)(n.br,{}),"\n","Requests access on behalf of the resource owner"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorization Server"}),(0,r.jsx)(n.br,{}),"\n","Issues tokens after consent"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource Server"}),(0,r.jsx)(n.br,{}),"\n","Validates tokens and enforces scopes"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Clear separation:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"OAuth2 grants access"}),"\n",(0,r.jsx)(n.li,{children:"APIs enforce authorization"}),"\n",(0,r.jsx)(n.li,{children:"Clients never self-authorize"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"-tokens-scopes--grant-types",children:"\ud83d\udd10 Tokens, Scopes & Grant Types"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Access Token"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Represents delegated permission"}),"\n",(0,r.jsx)(n.li,{children:"Sent to resource servers"}),"\n",(0,r.jsx)(n.li,{children:"Scoped and audience-limited"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Refresh Token"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Used to obtain new access tokens"}),"\n",(0,r.jsx)(n.li,{children:"Must be stored securely"}),"\n",(0,r.jsx)(n.li,{children:"High-risk if leaked"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Grant Types"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authorization Code (user + browser)"}),"\n",(0,r.jsx)(n.li,{children:"Authorization Code + PKCE (default)"}),"\n",(0,r.jsx)(n.li,{children:"Client Credentials (service-to-service)"}),"\n",(0,r.jsx)(n.li,{children:"Device Code (TV / CLI)"}),"\n",(0,r.jsx)(n.li,{children:"Refresh Token (renewal only)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"-security-validation--operations",children:"\ud83e\uddea Security, Validation & Operations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Validate access tokens on every request"}),"\n",(0,r.jsx)(n.li,{children:"Enforce scopes and audience strictly"}),"\n",(0,r.jsx)(n.li,{children:"Revoke compromised tokens"}),"\n",(0,r.jsx)(n.li,{children:"Rotate signing keys"}),"\n",(0,r.jsx)(n.li,{children:"Log authorization failures"}),"\n",(0,r.jsx)(n.li,{children:"Monitor unusual token usage"}),"\n",(0,r.jsx)(n.li,{children:"Design for token expiration and renewal"}),"\n",(0,r.jsx)(n.li,{children:"Separate auth server outages from API availability"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"-explanation-style",children:"\ud83d\udcdd Explanation Style"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use OAuth2-correct terminology"}),"\n",(0,r.jsxs)(n.li,{children:["Explain ",(0,r.jsx)(n.em,{children:"why"})," a grant exists"]}),"\n",(0,r.jsx)(n.li,{children:"Call out misuse explicitly"}),"\n",(0,r.jsx)(n.li,{children:"Avoid identity language unless discussing OIDC"}),"\n",(0,r.jsx)(n.li,{children:"Prefer security clarity over developer convenience"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-user-owned",children:"\u270d\ufe0f User-owned"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["These sections must come from the user.",(0,r.jsx)(n.br,{}),"\n","They define ",(0,r.jsx)(n.strong,{children:"business intent, risk tolerance, and system shape"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-what-task--action",children:"\ud83d\udccc What (Task / Action)"}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Secure an API using OAuth2"}),"\n",(0,r.jsx)(n.li,{children:"Choose the correct grant type"}),"\n",(0,r.jsx)(n.li,{children:"Design scopes for a service"}),"\n",(0,r.jsx)(n.li,{children:"Review OAuth2 implementation"}),"\n",(0,r.jsx)(n.li,{children:"Integrate third-party API access"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-why-intent--goal",children:"\ud83c\udfaf Why (Intent / Goal)"}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Protect APIs"}),"\n",(0,r.jsx)(n.li,{children:"Enable third-party integrations"}),"\n",(0,r.jsx)(n.li,{children:"Enforce least privilege"}),"\n",(0,r.jsx)(n.li,{children:"Support zero-trust architecture"}),"\n",(0,r.jsx)(n.li,{children:"Meet compliance requirements"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-where-context--situation",children:"\ud83d\udccd Where (Context / Situation)"}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Backend APIs"}),"\n",(0,r.jsx)(n.li,{children:"API gateway"}),"\n",(0,r.jsx)(n.li,{children:"Microservices"}),"\n",(0,r.jsx)(n.li,{children:"Mobile or SPA clients"}),"\n",(0,r.jsx)(n.li,{children:"Machine-to-machine systems"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-when-time--phase--lifecycle",children:"\u23f0 When (Time / Phase / Lifecycle)"}),"\n",(0,r.jsx)(n.p,{children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Initial system design"}),"\n",(0,r.jsx)(n.li,{children:"Security hardening"}),"\n",(0,r.jsx)(n.li,{children:"Platform migration"}),"\n",(0,r.jsx)(n.li,{children:"Pre-production review"}),"\n",(0,r.jsx)(n.li,{children:"Incident response"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-final-prompt-template-recommended-order",children:"\ud83d\udd17 Final Prompt Template (Recommended Order)"}),"\n",(0,r.jsx)(n.h3,{id:"1\ufe0f\u20e3-persistent-context-put-in-security-docs-or-readme",children:"1\ufe0f\u20e3 Persistent Context (Put in security docs or README)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-md",children:"# Authorization Rules \u2014 OAuth 2.0\n\nYou are working in a system that uses OAuth 2.0.\n\n## Core Principles\n\n- OAuth2 is for authorization\n- OIDC is for authentication\n- Least privilege via scopes\n\n## Token Rules\n\n- Validate audience and scope\n- Short-lived access tokens\n- Refresh tokens handled securely\n\n## Security\n\n- Authorization Code + PKCE only\n- Never use Implicit Flow\n- Assume token leakage\n- Rotate keys and revoke aggressively\n\n## Architecture\n\n- Auth server issues tokens\n- Resource servers enforce access\n- Clients never self-authorize\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"2\ufe0f\u20e3-user-prompt-template",children:"2\ufe0f\u20e3 User Prompt Template"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"What I want to do:\n[Describe the OAuth2 authorization problem or design.]\n\nWhy it matters:\n[Security, access control, compliance.]\n\nWhere this applies:\n[API, gateway, service-to-service, client.]\n(Optional)\n\nWhen this is needed:\n[Design, implementation, audit.]\n(Optional)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"-fully-filled-example",children:"\u2705 Fully Filled Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"What I want to do:\nDesign OAuth2 scopes for a public REST API.\n\nWhy it matters:\nWe need fine-grained access control for third-party developers.\n\nWhere this applies:\nPublic SaaS API behind an API gateway.\n\nWhen this is needed:\nDuring initial platform security design.\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-why-this-ordering-works",children:"\ud83e\udde0 Why This Ordering Works"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorization first"})," avoids identity confusion"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scopes before tokens"})," enforces least privilege"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Architecture before code"})," prevents insecure shortcuts"]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["OAuth2 defines access.",(0,r.jsx)(n.br,{}),"\n","OIDC defines identity.",(0,r.jsx)(n.br,{}),"\n","Authorization defines power."]})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"Happy securing APIs with OAuth 2.0 \ud83d\udd11\ud83d\udee1\ufe0f"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},2327(e,n,s){s.d(n,{R:()=>l,x:()=>o});var i=s(9081);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);